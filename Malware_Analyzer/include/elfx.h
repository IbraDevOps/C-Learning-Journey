#ifndef ELFX_H
#define ELFX_H

#include <stddef.h>
#include <stdbool.h>  // for bool
#include <stdint.h>   // for uint16_t etc.

/*
 * Structure summarizing key ELF metadata for analysis/reporting
 */
struct elf_summary {
    char class_str[16];
    char endian_str[16];
    char machine[64];
    unsigned long long entry;
    bool pie;
    bool has_symtab;
};

/*
 * Summarize ELF binary metadata
 * Returns 0 on success, -1 on failure (error message in errbuf)
 */
int elf_summarize(const char *path, struct elf_summary *out, char *errbuf, size_t errlen);

#endif
