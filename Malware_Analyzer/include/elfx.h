#ifndef ELFX_H
#define ELFX_H
#include <stdbool.h>
#include <stddef.h>
#include <stdint.h>

struct elf_summary {
    char     class_str[8];   // ELF32/ELF64/UNKNOWN
    char     endian_str[8];  // LE/BE/?
    char     machine[32];    // x86_64/arm/...
    uint64_t entry;          // entry point
    bool     pie;            // ET_DYN -> likely PIE
    bool     has_symtab;     // rough stripped indicator
};

int elf_summarize(const char *path, struct elf_summary *out, char *err, size_t errlen);
#endif
