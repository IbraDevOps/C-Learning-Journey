#ifndef JAIL_H
#define JAIL_H
#include <stddef.h>

struct jail_opts {
    const char *root; /* temp dir to use (NULL -> auto mkdtemp) */
    int make_netns;   /* 1=new network namespace (empty stack) */
    int readonly;     /* bind mounts as read-only */
};

int jail_enter(const struct jail_opts *opt, char *err, size_t errlen);
/* Call in the CHILD before exec(): unshare ns, setup mounts, chroot, chdir("/") */

#endif
