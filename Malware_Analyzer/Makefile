#cat > Malware_Analyzer/Makefile <<'MAKE'
CC      ?= gcc
CFLAGS  ?= -std=c11 -Wall -Wextra -Werror -O2 -fstack-protector-strong -D_FORTIFY_SOURCE=2
PKGS     = openssl

# Optional seccomp (no-net). If pkg-config finds it, weâ€™ll link it; else compile with NO_SECCOMP.
SECCOMP_CFLAGS := $(shell pkg-config --cflags libseccomp 2>/dev/null)
SECCOMP_LIBS   := $(shell pkg-config --libs   libseccomp 2>/dev/null)

CFLAGS += $(shell pkg-config --cflags $(PKGS) 2>/dev/null) $(SECCOMP_CFLAGS)
LDLIBS += $(shell pkg-config --libs   $(PKGS) 2>/dev/null) $(SECCOMP_LIBS)

ifeq ($(strip $(SECCOMP_LIBS)),)
CFLAGS += -DNO_SECCOMP
endif

INC := -Iinclude
SRC := src/main.c src/elf_parser.c src/utils.c src/report.c src/sandbox.c
BIN := malx

all: $(BIN)

$(BIN): $(SRC)
	$(CC) $(CFLAGS) $(INC) $^ $(LDLIBS) -o $@

clean:
	rm -f $(BIN) *.o
.PHONY: all clean

